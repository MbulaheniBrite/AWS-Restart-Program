## ğŸ›¡ï¸ How I Implemented AWS Network Firewall: Fighting Malware

## ğŸš€ What This Project Is About

In this project, I documented my process of deploying and configuring **AWS Network Firewall** to establish a network-level defense against common malware threats. I focused on creating a high-security firewall policy and deploying **stateful rule groups** using **Suricata compatible rule strings** to actively block malicious outbound traffic.

---

## ğŸ¯ What I Accomplished

*  **VPC Integration:** I successfully deployed the firewall into a specified VPC.
*  **Policy Creation:** I created the foundational LabFirewallPolicy.
*  **Stateless Configuration:** I defined Pass for full packets and Drop for fragmented packets (as an anti-evasion measure).
*  **Stateful Rule Group:** I created a StatefulRuleGroup with a capacity of **100**.
*  **Threat Mitigation:** I verified that access to known malicious sites was successfully blocked after deployment.

---

## ğŸ”¬ How I Implemented Everything

### 1. ğŸ” Testing Before the Firewall (Baseline)

Before I configured anything, I tested connectivity to a known malware repository (malware.wicar.org) using wget to establish a baseline of unrestricted access.

<img width="1368" height="483" alt="1" src="https://github.com/user-attachments/assets/db2ab31d-7a33-4ae3-a396-ac06d9e48147" />

<br></br>
> ğŸ“ **What I Found:** Outbound traffic was permitted, and I could successfully download sample files (js_crypto_miner.html and java_jre17_exec.html).
<br></br>
<img width="1426" height="566" alt="2" src="https://github.com/user-attachments/assets/75f6e56e-0104-417a-bfa8-a317c89630be" />
<br></br>
<img width="1408" height="687" alt="3" src="https://github.com/user-attachments/assets/614eb7f0-ac7b-46ea-bc49-86bbe80d9bf5" />
<br></br>
### 2. ğŸ§± Setting Up My Firewall Policy

I established the core policy (LabFirewallPolicy) and applied crucial default settings to control how packets flow through my network.

<img width="1404" height="705" alt="4" src="https://github.com/user-attachments/assets/877c88c2-db24-44c5-8677-886d0993c872" />

* **Policy Name:** LabFirewallPolicy
* **Stateless Default Action (Full Packets):** **Pass**
* **Stateless Default Action (Fragmented Packets):** **Drop** (I did this to prevent evasion through packet reassembly issues.)

<img width="1403" height="631" alt="5" src="https://github.com/user-attachments/assets/c26f5016-045e-44a4-91b0-e77169c0ea4e" />

### 3. ğŸ“ Creating My Stateful Rule Group

I created a dedicated stateful rule group to house my custom security signatures. Stateful inspection is critical because it evaluates traffic within the context of the established flow.

<img width="1406" height="670" alt="6" src="https://github.com/user-attachments/assets/6c0ac379-5070-48d0-9295-e426fe3cd404" />

| What I Configured | What I Set | Why I Did This |
| :--- | :--- | :--- |
| **Rule Group Name** | StatefulRuleGroup | For easy identification |
| **Type** | **Stateful** | For deep inspection within traffic flow context |
| **Format** | **Suricata compatible rule string** | This allows for powerful, industry-standard threat signatures |
| **Capacity** | **100** | My initial maximum rule count |

<img width="1408" height="684" alt="7" src="https://github.com/user-attachments/assets/04c9bd98-0dbd-47c9-8ef1-85679575de09" />
<br></br>
<img width="1406" height="634" alt="8" src="https://github.com/user-attachments/assets/0230b039-b9a3-4428-a19d-38831708d94a" />
<br></br>
### 4. ğŸ”— Linking My Firewall and Policy

I deployed the main firewall resource (LabFirewall) and linked it to my LabFirewallPolicy. This action ensured that my policy, along with all associated rule groups, became active for traffic inspection.

<img width="1402" height="617" alt="9" src="https://github.com/user-attachments/assets/6846e3d9-b888-4492-8270-14f4d17faad0" />

>  **Firewall Status:** My LabFirewall resource transitioned to **Ready** status after I successfully associated it with the policy and target VPC.

<img width="1843" height="748" alt="10" src="https://github.com/user-attachments/assets/59b17ecf-642f-41a8-83bf-c18c389e1f51" />

### 5.  Testing After Deployment

After I associated my newly created StatefulRuleGroup (configured with the block rules) with my LabFirewallPolicy, I repeated the initial baseline test to see if it worked.

<img width="1823" height="574" alt="11" src="https://github.com/user-attachments/assets/f593d308-cd50-4415-a640-db5c0a2921e0" />

| What I Tested | What Happened Before | What Happened After |
| :--- | :--- | :--- |
| **wget to malware site** | **200 OK** (Download success) | **Connection Blocked/Dropped** |

> ğŸ”’ **My Conclusion:** My firewall successfully blocked access to malicious sites, confirming that I effectively deployed and enforced the security rules!

<img width="1222" height="353" alt="12" src="https://github.com/user-attachments/assets/dc7f25b1-64ce-44cf-831c-d2f38087442d" />

---

## ğŸ”§ Tools and Services I Used

* **AWS Virtual Private Cloud (VPC):** This provides the isolated network environment I needed.
* **AWS Network Firewall:** The primary security service I used for L3-L7 traffic filtering.
* **Stateful Inspection:** I utilized this for advanced, context-aware rule processing.
* **Suricata:** The compatible rule format I used for defining custom intrusion prevention rules.
